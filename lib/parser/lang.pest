WHITESPACE = _{ " " | "\n" | "\t" }
program = { SOI ~ (expression ~ ";")+ ~ EOI }

variable = @{ !(keyword ~ WHITESPACE) ~  (ASCII_ALPHA | "_") ~ (ASCII_ALPHA|ASCII_DIGIT|"_")* }
literal = { ASCII_DIGIT+ }


kw_read_int = _{ "read_int" }
kw_print = _{ "print_int" }
kw_let = _{ "let" }

keyword = _{
  kw_read_int
  | kw_let
}

bin_op = { "+" | "-" }
un_op = { "-" }

expression = { prim_expression ~ left_rec_expression? }

prim_expression = {
  paren_exp
  | let_in
  | unary_op
  | read_int
  | print
  | literal
  | variable
}

left_rec_expression = { 
  binary_op
}

paren_exp = { "(" ~ expression  ~ ")" }
let_in = { kw_let ~ variable ~ "=" ~ expression}
read_int = { kw_read_int }
print = { kw_print ~ "(" ~ expression ~ ")" }
unary_op = { un_op ~ expression }
binary_op = { bin_op ~ expression }
